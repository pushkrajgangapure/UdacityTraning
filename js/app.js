function init(){model.initializeMap(),model.searchPlaces(),model.loadingComplete(!0)}
var COLLAPSE_OPEN="panel-collapse pre-scrollable collapse",COLLAPSE_CLOSE="panel-collapse pre-scrollable collapse in",viewModel=function(){"use strict";var mapObject=this;mapObject.loadingComplete=ko.observable(!1),mapObject.error=ko.observable(!1),mapObject.errorText=ko.observable(""),mapObject.location={latitude:16.714994,longitude:74.460267},this.search=ko.observable(""),mapObject.initializeMap=function(){if("object"!=typeof google||"object"!=typeof google.maps)return mapObject.loadingComplete(!0),mapObject.error(!0),void mapObject.errorText("Please try reloading the page");var loc=new google.maps.LatLng(mapObject.location.latitude,mapObject.location.longitude),c={zoom:13,center:loc,disableDefaultUI:!0};mapObject.map=new google.maps.Map(document.querySelector("#map"),c),mapObject.mapCard=new google.maps.InfoWindow({maxWidth:250})},mapObject.isCollapsePnlOpen=ko.observable(!0),mapObject.collapsePanelClass=ko.computed(function(){return mapObject.isCollapsePnlOpen()?COLLAPSE_OPEN:COLLAPSE_CLOSE}),mapObject.onHotelsListClick=function(){mapObject.collapsePanelClass()===COLLAPSE_OPEN?mapObject.isCollapsePnlOpen(!1):mapObject.isCollapsePnlOpen(!0)},mapObject.places=ko.observableArray([]),mapObject.searchPlaces=function(){mapObject.error()||(console.log("Looking for hotels...."),apis.foursquare.getPlacesIn(mapObject.location,function(loc){return null===loc||loc.length<=0?(mapObject.error(!0),void mapObject.errorText("API did not return results in proper format")):(loc.forEach(function(mapObject){mapObject.photoPath=ko.observable(),mapObject.photoVisible=ko.observable(!0),apis.foursquare.getPhotosOf(mapObject,function(loc){if(mapObject.photos=loc.items,mapObject.photos.length<=0)mapObject.photoPath("http://placehold.it/100/FFFFCC/ffffff&text="+mapObject.name.toUpperCase()),mapObject.photoVisible(!1);else{mapObject.photoVisible(!0);var c=mapObject.photos[0];mapObject.photoPath(c.prefix+"100x100"+c.suffix)}})}),void mapObject.places(loc))},mapObject.handleError))},mapObject.filteredPlaces=ko.computed(function(){var loc=mapObject.search().toLowerCase();return loc?ko.utils.arrayFilter(mapObject.places(),function(mapObject){return-1!==mapObject.name.toLowerCase().indexOf(loc)}):mapObject.places()}),mapObject.mapMarkers=ko.observableArray([]),mapObject.setPlaceMarker=function(loc){mapObject.isCollapsePnlOpen(!0);var c=mapObject.filteredPlaces().indexOf(loc);mapObject.onSelectedPlaceClick(mapObject.mapMarkers[c],loc)},mapObject.clearMarkers=function(){for(var loc=0,c=mapObject.mapMarkers.length;c>loc;loc++)mapObject.mapMarkers[loc].setMap(null);mapObject.mapMarkers=[]},mapObject.createMapMarkers=function(loc){mapObject.clearMarkers();var c,d=loc;if("object"==typeof d&&"object"==typeof google){c=new google.maps.LatLngBounds;for(var e=0,f=d.length;f>e;e++){var g={lat:d[e].location.lat,lng:d[e].location.lng},h=new google.maps.Marker({position:g,map:this.map,icon:"images/loc.png"});mapObject.mapMarkers.push(h),mapObject.mapMarkers[e].setMap(this.map),c.extend(new google.maps.LatLng(g.lat,g.lng)),d[e].bounds=c,h.addListener("click",mapObject.onMapMarkerClick(h,d[e]))}
this.map.setCenter(c.getCenter()),this.map.fitBounds(c)}},mapObject.createMapMarkers(mapObject.places()),mapObject.filteredPlaces.subscribe(function(){mapObject.createMapMarkers(mapObject.filteredPlaces())}),mapObject.disableAllMarkers=function(){mapObject.mapMarkers.forEach(function(mapObject){mapObject.setIcon("images/loc.png")})},mapObject.createMapMarkerCard=function(loc,c){mapObject.mapCard.close(),mapObject.disableAllMarkers(),mapObject.mapCard.setContent(mapObject.mapCardHtml(c)),mapObject.mapCard.open(mapObject.map,loc),mapObject.map.panTo(new google.maps.LatLng(c.location.lat,c.location.lng));var d=$("#collapseListGroupHeading1");mapObject.map.panBy(0,-(d.offset().top+d.height()+100)),loc.setIcon("images/location_1.png")},mapObject.onMapMarkerClick=function(loc,c){return function(){mapObject.createMapMarkerCard(loc,c)}},mapObject.onSelectedPlaceClick=function(loc,c){mapObject.createMapMarkerCard(loc,c)},mapObject.mapCardHtml=function(mapObject){(null===mapObject.location.city||"undefined"==mapObject.location.city)&&(mapObject.location.city="Ichalkaranji"),(null===mapObject.location.country||"undefined"==mapObject.location.country)&&(mapObject.location.country="India");var loc="<div class='card'><div class='card-block'><h4 class='card-title'>"+mapObject.name+"</h4><h6 class='card-subtitle text-muted'>"+mapObject.categories[0].name+"</h6></div><img src='"+mapObject.photoPath()+"' class='img-thumbnail'>";return loc=loc+"<div class='card-block'><p class='card-text text-justify'><loc>Address:</loc><span>"+mapObject.location.formattedAddress[0]+"</span></p><p class='card-text text-justify'>",loc=loc+"<h4><span class='label label-info'>"+mapObject.location.city+","+mapObject.location.country+"</span></h4>",loc=loc+"</p></div></div>"},mapObject.handleError=function(loc){mapObject.loadingComplete(!0),loc&&(console.log(loc),"object"==typeof loc?mapObject.errorText("Please try reloading the page"):"string"==typeof loc&&mapObject.errorText(loc)),mapObject.error(!0)}},model=new viewModel;$(document).ready(function(){ko.applyBindings(model)})